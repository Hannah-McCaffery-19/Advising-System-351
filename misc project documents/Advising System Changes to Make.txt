=== 4/12 DB Changes ===


TODO: meeting availability table for advisor
      evaluation table to store student evals

create department table before faculty table,
init. dept chair ID but do not add FK ref yet.
after creating faculty table,
add to FK ref to deptartment name:
deferrable initially deferred (pre ; )
after faculty table, add:

ALTER TABLE department
ADD CONSTRAINT `fk_dept_chair`
   foreign key (`dept chair ID`)
   references `mydb`.`Faculty` (`faculty ID`)
   deferrable initially deferred
   ON DELETE NO ACTION
   ON UPDATE NO ACTION;


-- assigned advising --
X Delete table


-- class --
Removals:
prefix
course number
room number
building name
semester
faculty ID (the non FK one)

Additions:
FK GCL_course ID

Name changes:
class location -> location

Type Change:
class ID: int(11) -> CHAR(4)
	- name change to CRN?
location: VARCHAR size 45 -> 15
FK faculty ID: int(11) -> CHAR(8)


-- [M:M] declared major -- 

Removals:
PK major ID
PK student ID
declare major
major name

Additions:
FK Majors_major name

Type changes:
FK Student ID -> int(11) -> CHAR(8)


-- [M:M] declared minor --

Removals:
PK minor ID
PK student ID
declared minor date
minor name

Additions:
FK Minors_minor name

Type changes:
Student ID -> int(11) -> CHAR(8)


-- department --

Removals:
PK department ID

Additions:
FK dept chair ID (type: CHAR(8))

Name changes:
department name -> dept name

Type changes:
dept name: VARCHAR size 45 -> 90
Assign dept name as PK


-- employing --
! Delete table


-- enrollment --
*Unimplemented


-- faculty --

Removals:
X salary

Additions:
X password VARCHAR(45) NOT NULL
create constraint to limit value of role to:
faculty, department chair, registrar

Type changes:
X faculty ID: INT -> CHAR(8)
X faculty phone: varchar(45) -> varchar(15)
X role: VARCHAR size: 20
X first name not null
X last name not null
X faculty email not null
X role not null default Faculty

Order changes:
X faculty ID at top
X faculty email after last name

Additions:
FK department name


-- general course listing --

Removals:
prefix
course number
semester
department
FK class ID

Additions:
course ID as PK
credit hours (type: INT(1))


-- location --
! Delete table


-- majors --
! Create table:

CREATE TABLE IF NOT EXISTS `mydb`.`Majors` (
  `major name` VARCHAR(45) NOT NULL,
  `department name` VARCHAR(90) NOT NULL,
  `required classes` TEXT NOT NULL,
  `elective classes` TEXT NULL,
  PRIMARY KEY (`major name`),
  INDEX `fk_Majors_dept_name_idx` (`department name` ASC),
  CONSTRAINT `fk_Majors_dept_name`
    FOREIGN KEY (`department name`)
    REFERENCES `mydb`.`Department` (`dept name`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION);


-- meeting --

Removals:
time
student ID (non FK)
Faculty ID (non FK)

Additions:
time start (type: DATETIME) NOT NULL
time end (type: DATETIME) NOT NULL
notes (type: TEXT) NULL

Type changes:
meeting ID: int(11) -> int(8)
Student_student ID -> int(11) -> CHAR(8)
Faculty_faculty ID -> int(11) -> CHAR(8)


-- minors --
! Create table:

CREATE TABLE IF NOT EXISTS `mydb`.`Minors` (
  `minor name` VARCHAR(45) NOT NULL,
  `department name` VARCHAR(90) NOT NULL,
  `required classes` TEXT NOT NULL,
  `elective classes` TEXT NULL,
  PRIMARY KEY (`minor name`),
  INDEX `fk_Minors_dept_name_idx` (`department name` ASC),
  CONSTRAINT `fk_Minors_dept_name`
    FOREIGN KEY (`department name`)
    REFERENCES `mydb`.`Department` (`dept name`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION);


-- override --
*Unimplemented


-- sending pin --
*Unimplemented


-- student --

Removals:
X pin number (redundant w alt ID)
X evaluation grade (getting its own table)

Additions:
X password VARCHAR(45) NOT NULL

Name changes:
X address -> student address
X phone number -> student phone
X graduation year -> year graduating
X student alternative PIN -> alternate PIN
X Faculty_faculty ID -> advisor ID

Type changes:
X student ID: INT -> CHAR(8)
X advisor ID: INT -> CHAR(8)
X advisor ID as FK ref faculty ID @ Faculty
X student phone: VARCHAR size: 45 -> 15
X student email: VARCHAR size: 45 -> 60
X student email: VARCHAR size: 45 -> 80
X year enrolled: DATE -> YEAR
X year graduating: DATE -> YEAR
X first name not null
X last name not null
X student email not null
X year enrolled not null
X year enrolled not null
X accumulated credits not null default 0

Order changes:
X first name above last name
X student email after last name
X student phone after student email
X student address after student phone


-- Records --
X Create table:

CREATE TABLE IF NOT EXISTS `mydb`.`Records` (
  `Student_student ID` CHAR(8) NOT NULL,
  `GCL_course ID` VARCHAR(8) NOT NULL,
  `grade` DECIMAL(1,1) NOT NULL,
  INDEX `fk_Records_Student_ID_idx` (`Student_student ID` ASC),
  CONSTRAINT `fk_Records_Student_ID`
    FOREIGN KEY (`Student_student ID`)
    REFERENCES `mydb`.`Student` (`student ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  INDEX `fk_Records_course_ID_idx` (`GCL_course ID` ASC),
  CONSTRAINT `fk_Records_course ID`
    FOREIGN KEY (`GCL_course ID`)
    REFERENCES `mydb`.`General Course Listing` (`course ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION);

